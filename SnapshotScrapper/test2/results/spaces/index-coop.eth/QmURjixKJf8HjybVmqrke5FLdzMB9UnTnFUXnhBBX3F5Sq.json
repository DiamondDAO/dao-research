{"id": "QmURjixKJf8HjybVmqrke5FLdzMB9UnTnFUXnhBBX3F5Sq", "title": "IIP-50: Upgrade FLI to Support Multiple Exchanges", "body": "**IIP**: 50\n**title**: Upgrade FLI to Support Multiple Exchanges\n**status**: Proposed\n**author**: Noah Citron (@ncitron), Richard Liang (@richard)\n**created**: 2021-6-23\n**discussion to:** https://gov.indexcoop.com/t/iip-50-upgrade-fli-to-support-multiple-exchanges/1798\n\n## Simple Summary\n\nUpdate both ETH2x-FLI and BTC2x-FLI to support levering and delevering using multiple exchanges.\n\n## Abstract\n\nThe Flexible Leverage Index uses a smart contract called FlexibleLeverageStrategyAdapter to execute rebalances. This contract currently only executes trades through a single exchange (Sushiswap). This upgrade allows us to pass in a list of enabled exchanges that our keeper bots may use. Initially, we will enable Sushiswap and Uniswap V3.\n\n## Motivation\n\nAs FLI products grow larger, we increasingly have to consider slippage on our trades. This is because as AUM grows our rebalancing trades must also scale. To combat this, we set a maximum trade size, and lever/delever the product slowly over multiple trades. While this solution has been sufficient under normal operation, it is a slow process since we must also set a minimum delay period between trades to allow the Sushiswap pool to be arbitraged back to the correct price. During rapid price changes, this bottleneck can prevent us from delevering fast enough, leading to liquidation risk. This constraint is part of the reason why FLI supply caps must be maintained.\n\nEnabling FLI to use a list of whitelisted exchanges to rebalance has several advantages. First, minimum trade delays can be enforced on a per-exchange basis. This means that we can execute a rebalancing trade for each exchange simultaneously, increasing our rebalancing speed. Secondly, having access to multiple exchanges allows us to make use of Uniswap V3. Uniswap V3 almost always will allow us to execute large trades with low price impact, but occasionally produces suboptimal trades for brief periods when price moves outside of liquidity providers' preset range, and high gas prices are preventing them from redeploying their liquidity. By utilizing multiple exchanges, we can easily direct our keeper bots to use Uniswap V3 as the primary exchange, with Sushiswap as a backup. By utilizing Uniswap V3 in this way, we will be able to achieve a 3-6x increase in our existing trade size and delevering speed.\n\nOverall, this change significantly improves FLI's safety and will allow us to have more confidence when increasing the FLI supply caps.\n\n## Specification\n\n### Overview\n\nThe FlexibleLeverageStrategyAdapter is responsible for controlling FLI's rebalancing operations. This change will require deploying two new versions of this contract (one for each FLI product). \n\n### Technical Specification\n\nThe proposed changes to the contract can be viewed on GitHub here:\nhttps://github.com/SetProtocol/index-coop-smart-contracts/pull/59\n\nAdditionally, we will have to execute five transactions per FLI product from the Index Coop multisig to enable these adapters. A table detailing them is provided below:\n\n\n| To | Description |\n| -------- | -------- | -------- |\n| Old FLI strategy adapter | Withdraw ripcord incentive |\n| BaseManager | Add new adapter to BaseManager |\n| New FLI strategy Adapter | Whitelist the keeper bots |\n| New FLI strategy Adapter | Send ripcord incentive |\n| BaseManager | Remove old FLI strategy Adapter |", "choices": ["FOR", "AGAINST"], "start": 1624903200, "end": 1625162400, "snapshot": "12704668", "state": "closed", "author": "0xB0Ff82C91178f66aA40224Abd425E2AC7AE28ceA", "space": {"id": "index-coop.eth", "name": "Index"}, "votes": 65, "votes_data": [{"id": "QmXwKipKehcNGWoPPbmmRxe5PZmNTx8tybVcQfjstuhwp3", "voter": "0x3c92fDACE3779D4241A1990b218cE8223779a090", "created": 1625161745, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "Qmee4497VWwgxxkscuKMC9KuHaBY6ua1uoEF35TPnW6Tha", "voter": "0x6C6A396eED6E00cbAd6588110d3653415beC7B77", "created": 1625146167, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmaqjM2SZdh4mVGB5CcSZ8EPzon5fE2TqKAit4QGnqjxwZ", "voter": "0xF3b2F2dAbD734931295224f86e0eb678C88320FB", "created": 1625121237, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmU8AYi8H2vteMHK3PhYJHy1XgVu8broWkr6VFXtPSZGMi", "voter": "0x887C3599c4826F7b3cDe82003b894430F27d5b92", "created": 1625103572, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmTjVtFGwXAPby8cXKqNoTM27P3LAP7TrKci9GFYLSy2UP", "voter": "0x28A4E12c38f052A4D9FaaF17914ff6363AE97DF4", "created": 1625088013, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmeYePAaYtzQ6kjAFCgRRpaiCTmBpdVuqZr9CTeeVYmWLD", "voter": "0x80bF87E5Ef44D943380279142B2B288EAf73a571", "created": 1625081705, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmREk2cr2hcyjUwka5qtkK1i4e6rJSK2BfTpYg6FKD349i", "voter": "0xA32E9A93407C629D1a952bdAdc0D2f72887d0326", "created": 1625081183, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmPGpoyNmu9UdHC6nkGDQWssWrpLyK412BQ1zvsFvsAJqn", "voter": "0x035bC96201666333294C5A04395Bb3618a2b6A11", "created": 1625079721, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmdpRxZPYkoG7sRMKWTuREXFMi3qmvPuGLQQ3to6jdrpTY", "voter": "0x6B1050C1C6B288C79Ac1db299Dc481048aBBBbcD", "created": 1625072647, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "Qmd4Y7SUnjT4Dfy35poxVdeJq1TP2SZz4RHijzGesxHUD1", "voter": "0x8d07D225a769b7Af3A923481E1FdF49180e6A265", "created": 1625067548, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmRwHKSdiPmmBePiQVwZLDuW6bGG7jtyMupk25QWQghif3", "voter": "0x99b5Fb37B04C966dCaF1EDB5eA27B08644Cc4d08", "created": 1625065651, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmTCcNkA1HD61fgedmJCgfk6MSdXfoBGfrYqaoSQ5CsB4z", "voter": "0xA386621F99D2B74DE33051cd5A5d00967668afDd", "created": 1625065635, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmPL6dBr57YU6QEMtYEJCxmKSGdDQtb1rRJMVddYUkjC2k", "voter": "0xd88138A5D451294724126B32E441602eAF7ff62d", "created": 1625064340, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmPaCRUfvB2EMpgJYLUSuVh2PWwGcyFuXdF7WjHYW8fxy8", "voter": "0x6fC5ea97BB80750F56266D6c2615315e54E1305f", "created": 1625063230, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmRDHD691kMsrx32rcLT1dNj6jbNJrgzHrKNbQ3hY7cBUr", "voter": "0x1d11e78148849200f3e937f31e8A9F66433E69f8", "created": 1625058596, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmYbvPkvWM14nPMfgPyjNCJ3wVDcWrJmDpFYwHCp5dSqCv", "voter": "0x61a17076F014Fd248d72258bC9CCbaEbA49Ccd8C", "created": 1625055932, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmWgmZ27Z2LN394EQ6dhduv7ze5RtoiNUahjmSYEDuA7eA", "voter": "0xECbe3854B26750B301341BAD149185E55544aBA1", "created": 1625053125, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmTGkzyBPQ8tGdfuDopWvNQTMctpmGCVEBm3RnR2JTUqep", "voter": "0x0100e4f2a841e773564c333f889ab6D6Bd5FcB22", "created": 1625023763, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmWeERnt7bM6ovix4rSUVZyxzzGTkczyosdMy6Yw37V9uY", "voter": "0xEe009c8c4329b6Da7eBA8103cf866d1ed13e82d2", "created": 1625023734, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmTHHkniGFsKKGzKrcCptP9ekudGp6gxSwrfcyTk8W67s6", "voter": "0x7E85B4eAFBa29De0584492DB667b11dae56bEaf8", "created": 1625017792, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmVHkjXxxQAJUL1SKKV6rsyq1KBJa2EKziomLVhhQqw9Yf", "voter": "0x5d8b04E983a2f83174530A3574E89F42E5Ee066E", "created": 1625014516, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmVT7yrnsKv9s84qPJqEMZZ51pe9cMxkcSatDWJoCFmqxq", "voter": "0xdC417bE74f7Edd8C7587049f227A360ED0876CB6", "created": 1625013211, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmTL8xYaVFxaAmGV1zYBhBeACSraVHG2QxTg9U2FUkwxm1", "voter": "0xf6401adc23Faa6B9AD83eA8604CA7254CB7F53e7", "created": 1625009207, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmPCCHsrEMrke4ChmS5D5R51AtauTdj2rBUmeyoqe4Xwsi", "voter": "0xA1851e5fcC51C337213B086364762d5AaDEa2141", "created": 1625007794, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmZ125z3YG8aGeptpP3MhtnCCaUS57CVQqQJ2kLM5adkrg", "voter": "0xbA743394ca6c38886c066E45bb9980A09AeC7A65", "created": 1625000526, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmRddKeYY76Gd8VYjWFjBH6s4F2Uq1RvkTWhAv558tMCq1", "voter": "0xBA262A49004931bd65f077a045AeEf8C5978376b", "created": 1625000376, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmafqR8Tr98ySdt5TT62rRqrfMuVAZmc7PnU8oc8CEHxNk", "voter": "0x5CD4EF55C339ef01f79f494c0a568df90699Aa22", "created": 1624999770, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmZ9a4UTmMGnbM6XVe1SrHDTBDdVxJtdE4CW5DxcUCMVro", "voter": "0x1462f0C35a3e48027aD72bEf4E3925Aa4fB4a14d", "created": 1624992552, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmNgaNoUwmMdHZHrHAVf6Z7eHpnos8bPo5Z4WchoGQTHEX", "voter": "0x042a135bd342910ad7F67bBda74e3fd4125D1272", "created": 1624992307, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmQebgFMXvkLFD5sCQpPpnKx63xPaFv6EfLGquoCnoCCsT", "voter": "0x54f2c1D76cB23329F36afdaff363b28E123f76E3", "created": 1624986945, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmQUudpd4pdyr7kc2RNSCAryBZd4coCizieYYm4tGBKhdP", "voter": "0x085f66D0764c632cE8c1f2a41531909BEF106C75", "created": 1624979231, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmZmaRtPhgHifRHDBWGeHpUbyakN2YPnnomWxKuQgYLJiZ", "voter": "0x48A9789428F2067338D02B1EF3612DF64F05FeB7", "created": 1624979221, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "Qmd1xUodttFopegZku672M6yHe326Zo1LQEMS1xA6FQ872", "voter": "0x2E7E25eA3Fdd1CF87D0cF93872f17558399A5007", "created": 1624978806, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmZauVFQtbyGgg6c93RMAdUUeh5cfgMvCReLWs2S2xJCzP", "voter": "0x981CaC16246D9641bE07BbA6E19E304b74B173BC", "created": 1624974558, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmV7F9Vy92Qzr4moVWWNEihZsdcy2d7RLJUUm1VsXMkadU", "voter": "0x6E07663b21bD087a53739BC2109aC8360ebB0270", "created": 1624971573, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmS3rG59LehheF4MPaw4QAYz9aaAaWjkxTiEDZ6zJRD19J", "voter": "0x4f49D938c3Ad2437c52eb314F9bD7Bdb7FA58Da9", "created": 1624968422, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmUfp9Uv7tYMPxamhsCAJU3GTWchK3MaPuEZmAWForAVcD", "voter": "0x1b1134e588b411600A3BEea2244835b67A6A1CB7", "created": 1624964798, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmWpRmkkZr8Vh4CHNt5z3UrYjC5wYTnscfi1aJgFLABP2U", "voter": "0x0d896d05447Bd344Ef773552F4D0408718F3e054", "created": 1624961557, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmS2YVxG3JK1vYgtVSwkZzNbhE7fePCEtnmNPb2DLnAq2w", "voter": "0xd213f746d52002E3e84517790603018D7fCd2CeA", "created": 1624954810, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "Qma3GUoCGrEDBtXJERHoH4frMDxomFAisUzb2AASCQRiDc", "voter": "0xFA7513021002F7181333B773BF801DFD7fd91ce7", "created": 1624953922, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmdJLuDbtDXUSp5ZkD8UeNH5YctrUDVQTAeuhAMgASbQ9e", "voter": "0xeDC8501C9F4173e2A76Bff49C0B571f14903a7e7", "created": 1624943329, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmRnoidNR96KBvhbUTdKgyDDibbCqWUdiY1LXYzkMeNnAz", "voter": "0x2d590341D43185EecA048A1a8d0953c6F6b7a1fe", "created": 1624940903, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmNcnpyPw5nfTCYys6kDay1rjowi9ry4EbZ1iUtiKNv9Wk", "voter": "0x5e37Ecb749f81f2C300a00049413C7a4164a7403", "created": 1624939929, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmekmgjRydjdauJ6w6vk5rnqFgJ6B53o56R7bAobYSW97x", "voter": "0x78c0A25CcC21604B3D117100DE7c9523f53236C7", "created": 1624935109, "choice": 2, "space": {"id": "index-coop.eth"}}, {"id": "QmehDHRoWtvNQHrjuQXdMAtDA2rxGraPpDhTddRjTczokn", "voter": "0xBD1f7d88C76A86C60d41bDDD4819fAe404e7151E", "created": 1624930013, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmfYqfbgPkZPqWA35NosToH7HGz5FLsUtoDjfwuN1s4Aeq", "voter": "0x76Da9F88e63a85Ba8BFA19F3821D5A271753D3dc", "created": 1624923931, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmYjoW3FRLvXMwe35Cj8upd9nWSFSdq6q5Lo6jUvUdkbN7", "voter": "0x6352a7db401e6e330De405077e8b969863328de8", "created": 1624920410, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmY3k1UXb5MSoowBTGt91APy2mw4Rvo3t9sqPdcdB3Qgoo", "voter": "0xF3862Af14CBb4d9B781e41a3D4d74E7C2cDB73E2", "created": 1624920293, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmcDHNL8gbcmVVRrf7pMUTfkM3RqEXS9oD3tDNcQEhr5K2", "voter": "0x0cD25946115f3c474A123b9147E7c5fA89c1e721", "created": 1624920279, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmVmHCRRj6exsjFZ9VbsidWrB3ihQEJAQ4WySFV3PjramN", "voter": "0x128e5625e15FdBA91d6CcB1AbDFdC62b5d152b4f", "created": 1624920115, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmVZ8cRdbt7oChJ5CcFMzJtvieNmjancjdy2NcnUsquDJM", "voter": "0x4AdA1B9D9fe28aBd9585f58cfEeD2169A39e1c6b", "created": 1624919727, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmPf5xNDAWXnS9J8RTm6PAHHK6rTxy23HNoj2USRWzTHJP", "voter": "0x653d63E4F2D7112a19f5Eb993890a3F27b48aDa5", "created": 1624917807, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmWb71mUxFghwQdHwyfjhUGezVLsi2hE5yAnxSGfDTHXSQ", "voter": "0x303EeFeDeE1bA8e5d507a55465d946B2fea18583", "created": 1624917323, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmReR1mtoxU5indaj35WLndy9eX436uQyf7PfQGzoNYZCH", "voter": "0x49084125E425eD84a81e97F866043Ba413E959b9", "created": 1624916330, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmNVx4ULg96Ln5v3kM6Q3iu7XcstKDegkpKMLA3xYHdiPf", "voter": "0x2628A53BFaAF75580636c5577EEb0D21888D0A7b", "created": 1624915650, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmPxM1rD17Q77PZjW5NwbZi67kbChHBt6YiyU7ckVL8h86", "voter": "0xC42705A210f082ff29E6bEAc80F56C41F0A54091", "created": 1624914063, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmX4st6cyJYJaLAhPd8PwSsCNwyCCp9QXKxvxV4VCASTBP", "voter": "0x4ABc33CF81e0d21f42168d044f7002eDd6b80B09", "created": 1624913984, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmQURT8TPPsYYayBywHf9a8v6SwPVqLuxX8eGZTxLru6Cj", "voter": "0xEE48671f1E55BEF74103b5C496E861c18Ee71dad", "created": 1624913828, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmYi25aJBsmpTni7w8VcBEN9uXCpBHDqNSsvewoMxL9PxE", "voter": "0xe8787b5a359c30318D9b805651D18275f33Fa1Bd", "created": 1624913442, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmXmn1csAXGRfJ5ic14KeRZ7zH4W7LD2c5RPC2fXsKegP5", "voter": "0x421f223e19877D9765Ecd6e8EC4812457229B36A", "created": 1624913164, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmaxVQCq357ftPxs7SJc7mfTjxCot8oZJis7eiQV7PbgSw", "voter": "0xD3D555Bb655AcBA9452bfC6D7cEa8cC7b3628C55", "created": 1624913122, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmWns6QAcK9rXAN9WzvwK6eAQb43Xa6EPWSbW6Y2MmKxUh", "voter": "0x9A6c02Eb5F511EBf2dFb4309F4b30cd5d02a44F6", "created": 1624913097, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmQhNj4eDksAhuZ65t4Uq5u7hZzPnPLjyKKaYQcJWSt53h", "voter": "0x1023b4fF494D49626D8485FC29c224e5b8B82a17", "created": 1624912482, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmP2kyv1HoUU48Z2AvFHJ6Ms9hMvbRco6JX4HTRWR3Uzv3", "voter": "0x8062E69aF89430d0749697ceDE9614Cda80325e0", "created": 1624912469, "choice": 1, "space": {"id": "index-coop.eth"}}, {"id": "QmUQJtbn5jffh8wLgraFx7xh43cmajJMrZDAC1H1nCAvSH", "voter": "0x705A42EcC5dF243BF9298f1D091b89761522a796", "created": 1624904191, "choice": 1, "space": {"id": "index-coop.eth"}}]}